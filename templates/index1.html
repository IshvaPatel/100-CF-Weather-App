<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Weather App</title>
    <link rel="stylesheet" href="../static/styles.css">
    <script src="../static/weather.js" type="text/javascript"></script>
</head>
<body>
    <div class="header-bar">
        <h1>Weather App</h1>
    </div>
    <input type="text" id="city" placeholder="Enter city name">
    <h5>Please provide the city name.<br>Use the format city name, state code (only for the US) and country code divided by comma. Please use ISO 3166 country codes.</h5>
    <button onclick="fetchWeather()">Get Weather</button>

    <div id="weather-info" style="display: none;"></div>
    <div id="weather-info2" style="display: none;">
        <p>Temperature: <span id="temperature"></span></p>
        <p>Wind Speed: <span id="wind-speed"></span></p>
        <p>Humidity: <span id="humidity"></span></p>
    </div>
    
    <br>
    <button onclick="saveFavorite()">Save as Favorite</button>
    <br>
    <h2>Enter City Name for Weather Forecast</h2>
    <form id="forecast-form">
        <label for="city">City:</label>
        <input type="text" id="city" name="city" required>
        <button type="submit">Get Forecast</button>
    </form>
    <script>
        document.getElementById("forecast-form").addEventListener("submit", function(event) {
            event.preventDefault(); // Prevent default form submission
            
            var city = document.getElementById("city").value; // Get the city input value
            
            // Make an AJAX request to fetch the forecast data
            fetch("/", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({ city: city }) // Send city name in JSON format
            })
            .then(response => response.json())
            .then(data => {
                // Display the forecast information
                displayForecast(data);
            })
            .catch(error => {
                console.error("Error:", error);
            });
        });
        
        function displayForecast(forecastData) {
            // Show the forecast information div
            document.getElementById("forecast-display").style.display = "block";
            
            // Get the table element
            var table = document.getElementById("forecastTable");
            
            // Clear any existing rows
            table.innerHTML = `
                <tr>
                    <th>Date</th>
                    <th>Temperature (°F)</th>
                    <th>Humidity (%)</th>
                    <th>Wind Speed (m/s)</th>
                </tr>
            `;
            
            // Populate the table with forecast data
            forecastData.forEach(row => {
                var newRow = table.insertRow();
                newRow.insertCell().innerText = row.index;
                newRow.insertCell().innerText = row.Temperature;
                newRow.insertCell().innerText = row.Humidity;
                newRow.insertCell().innerText = row['Wind Speed'];
            });
        }
    </script>
        
    <div id="forecast-display" style="display: none;">
        <h3>Weather Forecast for the next 10 hours</h3>
        <table id="forecastTable">
            <tr>
                <th>Date</th>
                <th>Temperature (°F)</th>
                <th>Humidity (%)</th>
                <th>Wind Speed (m/s)</th>
            </tr>
        </table>
    </div>
    <pre id="weather-info"></pre>

    <h2>Favorite Searches</h2>
    <ul id="favorites-list"></ul>
</body>
</html>
